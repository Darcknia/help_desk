<odoo>
  <data>
    <!-- contact form view -->
    <record id="nunoasegura_contact_form" model="ir.ui.view">
        <field name="name">nunoasegura.procedure.contact.form</field>
        <field name="model">res.partner</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group>
                        <field name="name"/>
                        <field name="email"/>
                        <field name="phone"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

   
    <!-- procedure tree view -->
    <record id="nunoasegura_procedure_tree" model="ir.ui.view">
        <field name="name">nunoasegura.procedure.tree</field>
        <field name="model">nunoasegura.procedure</field>
        <field name="arch" type="xml">
            <tree>
                <field name="id"/>
                <field name="created_at"/>
                <field name="channel"/>
                <field name="operator"/>
                <field name="priority" widget="priority"/>
                <field name="description"/>
                <field name="unidad_vecinal"/>
                <field name="cuadrante"/>
                <field name="state"/>
            </tree>
        </field>
    </record>

    <!-- procedure form view -->
    <record id="nunoasegura_procedure_form" model="ir.ui.view">
            <field name="name">nunoasegura.procedure.form</field>
            <field name="model">nunoasegura.procedure</field>
            <field name="arch" type="xml">
                <form string="Nuevo procedimiento">
                    <sheet>
                        <group>
                            <group>
                                <field name="created_at"/>
                                <field name="channel"/>
                                <field name="neighborhood_plan" attrs="{'invisible':[('channel', '!=', 'plan-barrial')]}"/>
                            </group>
                            <group>
                                <field name="operator"/>
                            </group>
                        </group>
                        <group>
                            <group>
                                <field name="category"/>
                                <field name="type" domain="[('category', '=', category)]"/>
                                <field name="priority" widget="priority"/>
                            </group>
                            <group>
                                <field name="description"/>
                                <field name="requester"  context="{'form_view_ref': 'nunoasegura.nunoasegura_contact_form'}" domain="[('user_ids','=',False),('is_company','=',False)]"/>
                                <field name="requester_phone"/>
                                <field name="requester_email"/>
                            </group>
                        </group>
                        <group>
                            <group>
                                
                                <field name="street"/>
                                <field name="address_number"/>
                                <field name="latitude" force_save="1"/>
                                <field name="longitude" force_save="1"/>
                                <field name="unidad_vecinal"/>
                                <field name="cuadrante"/>
                            </group>
                            <group>
                                <button name="reset_geolocation" string="Reiniciar Geo" type="object"/>
                                <field name="latlon" widget="openstreetmap" nolabel="1" force_save="1"/>
                            </group>
                        </group>     
                    </sheet>
                </form>
            </field>
        </record>


        <record id="nunoasegura_procedure_radio_form" model="ir.ui.view">
            <field name="name">nunoasegura.procedure.form</field>
            <field name="model">nunoasegura.procedure</field>
            <field name="arch" type="xml">
                <form string="Nuevo procedimiento">
                    <sheet>
                        <group>             
                            <group string="Asignar patrulla">
                                <!-- <field namex="inspectors2" widget="many2many_tags" options="{'no_create': True, 'no_open': True}"/> -->
                                <field name="patrols" widget="many2many_tags"/>
                                
                                <div style="margin-top: 50px; margin-bottom: 50px;">
                                    <div>
                                        <button name="mark_inspector_arrival" string="Marcar llegada al lugar" type="object"/>
                                    </div>
                                    <div style="margin-top: 10px;">
                                        <button name="close" string="Marcar fin del procedimiento" type="object"/>
                                    </div>
                                </div>

                                
                                <field name="created_at" readonly="1"/>
                                <field name="inspector_assigned_at" force_save="1"/>
                                <field name="inspector_arrival_at"/>
                                <field name="closed_at"/>

                                <field name="outcome"/>

                            </group>
                            <group string="Información del procedimiento">
                                <notebook>
                                    <page string="Dirección">
                                        <group>
                                            <field name="street"/>
                                            <field name="address_number"/>
                                            <field name="unidad_vecinal"/>
                                            <field name="cuadrante"/> 
                                        </group>
                                        <group>
                                            <field name="latlon" widget="openstreetmap" nolabel="1" force_save="1"/>
                                        </group>
                                    </page>
                                    <page string="Descripción">
                                        <group>
                                            <field name="channel" readonly="1"/>
                                            <field name="operator" readonly="1"/>
                                            <field name="type" readonly="1"/>
                                            <field name="priority" widget="priority"/>
                                            <field name="description" readonly="1"/>
                                            <field name="neighborhood_plan" attrs="{'invisible':[('channel', '!=', 'plan-barrial')]}"/>
                                        </group>
                                    </page>
                                    <page string="Solicitante">
                                        <group>
                                            <field name="requester_name"/>
                                            <field name="requester_phone"/>
                                            <field name="requester_email"/>
                                        </group>
                                    </page>
                                    
                                </notebook>
                            </group>
                            <group string="Observaciones del inspector">
                                <div class="oe_chatter">
                                    <field name="message_ids" widget="mail_thread"/> 
                                </div>
                            </group>
                        </group>
                        <!-- <group string="Comentarios y adjuntos">
                            
                        </group>
                        <group>
                            
                            
                        </group> -->

                        <!-- <button name="reset_geolocation" string="Reiniciar Geo" type="object"/> -->
                                     
                    </sheet>
                    
                </form>
            </field>
        </record>

<!-- 
        <record id="nunoasegura_procedure_phone_form" model="ir.ui.view">
            <field name="model">nunoasegura.procedure</field>
            <field name="inherit_id" ref="nunoasegura.nunoasegura_procedure_form"/>
            <field name="arch" type="xml">
                <field name="channel" position="attributes">
                    <attribute name="readonly">1</attribute>
                </field>
            </field>
        </record> -->



    <!-- procedure tree,form action -->
    <record id="nunoasegura_procedure_action" model="ir.actions.act_window">
        <field name="name">Procedimientos</field>
        <field name="res_model">nunoasegura.procedure</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{
            'form_view_ref': 'nunoasegura.nunoasegura_procedure_form'
        }</field> 
    </record>

    <record id="nunoasegura_procedure_phone_action" model="ir.actions.act_window">
        <field name="name">Procedimientos</field>
        <field name="res_model">nunoasegura.procedure</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{
            'form_view_ref': 'nunoasegura.nunoasegura_procedure_form',
            'default_channel': 'telefono'
        }</field> 
    </record>


    <record id="nunoasegura_procedure_radio_action" model="ir.actions.act_window">
        <field name="name">Asignar procedimientos</field>
        <field name="res_model">nunoasegura.procedure</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{
            'form_view_ref': 'nunoasegura.nunoasegura_procedure_radio_form' 
        }</field>
    </record>
    


    <!-- menus -->
    <menuitem id="nunoasegura_menu_root" name="Ñuñoa Segura" web_icon="nunoasegura,static/description/icon.png">
        <menuitem id="nunoasegura_procedure_menu_list" 
            name="Crear procedimiento" 
            action="nunoasegura_procedure_action"
            groups="nunoasegura.radiooperator_group,base.user_admin"/>
        <menuitem id="nunoasegura_procedure_menu_list_phone" 
            name="Crear procedimiento telefónico" 
            action="nunoasegura_procedure_phone_action"
            groups="nunoasegura.telephonist_group,base.user_admin"/>
        <menuitem id="nunoasegura_procedure_menu_list_radio" 
            name="Asignar procedimiento" 
            action="nunoasegura_procedure_radio_action"
            groups="nunoasegura.radiooperator_group,base.user_admin"/>
    </menuitem>

    <!-- explicit list view definition -->
<!--
    <record model="ir.ui.view" id="nunoasegura.list">
      <field name="name">nunoasegura list</field>
      <field name="model">nunoasegura.nunoasegura</field>
      <field name="arch" type="xml">
        <tree>
          <field name="name"/>
          <field name="value"/>
          <field name="value2"/>
        </tree>
      </field>
    </record>
-->

    <!-- actions opening views on models -->
<!--
    <record model="ir.actions.act_window" id="nunoasegura.action_window">
      <field name="name">nunoasegura window</field>
      <field name="res_model">nunoasegura.nunoasegura</field>
      <field name="view_mode">tree,form</field>
    </record>
-->

    <!-- server action to the one above -->
<!--
    <record model="ir.actions.server" id="nunoasegura.action_server">
      <field name="name">nunoasegura server</field>
      <field name="model_id" ref="model_nunoasegura_nunoasegura"/>
      <field name="state">code</field>
      <field name="code">
        action = {
          "type": "ir.actions.act_window",
          "view_mode": "tree,form",
          "res_model": model._name,
        }
      </field>
    </record>
-->

    <!-- Top menu item -->
<!--
    <menuitem name="nunoasegura" id="nunoasegura.menu_root"/>
-->
    <!-- menu categories -->
<!--
    <menuitem name="Menu 1" id="nunoasegura.menu_1" parent="nunoasegura.menu_root"/>
    <menuitem name="Menu 2" id="nunoasegura.menu_2" parent="nunoasegura.menu_root"/>
-->
    <!-- actions -->
<!--
    <menuitem name="List" id="nunoasegura.menu_1_list" parent="nunoasegura.menu_1"
              action="nunoasegura.action_window"/>
    <menuitem name="Server to list" id="nunoasegura" parent="nunoasegura.menu_2"
              action="nunoasegura.action_server"/>
-->
  </data>
</odoo>